{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/logger.ts","webpack:///./src/message-bus.ts","webpack:///./src/storage.ts","webpack:///./src/asynchrome.ts","webpack:///./src/utils.ts","webpack:///./src/popup.ts","webpack:///./src/resources.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","LogLevel","Logger","this","_name","window","logLevel","Info","debug","message","params","_level","Debug","console","log","__assign","timestamp","Date","component","info","warn","Warn","error","Error","default","Bus","_this","_subscriptions","chrome","runtime","onMessage","addListener","request","sender","sendResponse","type","filter","forEach","callback","on","push","send","sendMessage","response","Storage","Get","Promise","resolve","reject","storage","local","flag","Set","set","_a","Remove","remove","logger_1","storage_1","utils_1","Tabs","tabId","tabs","tab","find","query","test","url","queryInfo","executeScript","details","update","updateProperties","getCurrent","toggleMute","sent","newState","mutedInfo","muted","Notifications","clear","notificationId","notifications","isCleared","prefix","options","_logger","newGuid","id","duration","delay","s4","Math","floor","random","toString","substring","ms","setTimeout","getChromeVersion","raw","navigator","userAgent","match","parseInt","message_bus_1","resources_1","asynchrome_1","Main","_bus","initialize","evt","__awaiter","__generator","updateTrackInfo","updateTrack","hideActions","registerClicks","printConsoleGreetings","track","document","querySelector","classList","style","width","clientWidth","progress","volume","innerHTML","elapsed","shuffle_on","add","repeat_on","is_saved","isTabMuted","mute_on","is_paused","artist","title","art","setAttribute","length","lyric","lyrics","trim","_c","display","checked","_b","controls","getElementsByClassName","addEventListener","srcElement","box","getBoundingClientRect","cx","clientX","ox","offsetX","lx","layerX","x","sx","screenX","px","pageX","loc","location","level","preventDefault","toggle","Resources","urlChromeCommands","urlOss","urlPayPal","enabled","target","msgDontHack","msgBuyBeer","msgRate"],"mappings":"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","file":"popup.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","export class Logger {\r\n  get _level(): LogLevel {\r\n    if (typeof (window) !== \"undefined\") return (window as any).logLevel || LogLevel.Info;\r\n    return LogLevel.Info\r\n  }\r\n\r\n  private _name: string;\r\n\r\n  constructor(name: string) {\r\n    this._name = name;\r\n  }\r\n\r\n  public debug(message: any, params?: any) {\r\n    if (this._level > LogLevel.Debug) return;\r\n    // tslint:disable-next-line:no-console\r\n    console.log(message, { timestamp: new Date(), component: this._name, ...params });\r\n  }\r\n\r\n  public info(message: any, params?: any) {\r\n    if (this._level > LogLevel.Info) return;\r\n    // tslint:disable-next-line:no-console\r\n    console.info(message, { timestamp: new Date(), component: this._name, ...params });\r\n  }\r\n\r\n  public warn(message: any, params?: any) {\r\n    if (this._level > LogLevel.Warn) return;\r\n    // tslint:disable-next-line:no-console\r\n    console.warn(message, { timestamp: new Date(), component: this._name, ...params });\r\n  }\r\n\r\n  public error(message: any, params?: any) {\r\n    if (this._level > LogLevel.Error) return;\r\n    // tslint:disable-next-line:no-console\r\n    console.error(message, { timestamp: new Date(), component: this._name, ...params });\r\n  }\r\n}\r\n\r\nexport enum LogLevel {\r\n  None,\r\n  Debug,\r\n  Info,\r\n  Warn,\r\n  Error\r\n}\r\n\r\nexport default Logger;","export class Bus {\r\n    private _subscriptions: Subscription[];\r\n\r\n    constructor() {\r\n        this._subscriptions = [];\r\n        chrome.runtime.onMessage.addListener(\r\n            (request, sender, sendResponse) => {\r\n                if (typeof request.type === \"undefined\")\r\n                    return;\r\n                this._subscriptions\r\n                    .filter((s: Subscription) => {\r\n                        return s.type === request.type;\r\n                    })\r\n                    .forEach((s: Subscription) => {\r\n                        s.callback(request.message);\r\n                    });\r\n            });\r\n    }\r\n\r\n    public on(type: string, callback: callbackType) {\r\n        this._subscriptions.push({ type: type, callback: callback });\r\n    }\r\n\r\n    public send(type: string, message?: any) {\r\n        this._subscriptions\r\n            .filter((s) => s.type === type)\r\n            .forEach((s) => {\r\n                s.callback(message);\r\n            });\r\n        // tslint:disable-next-line:no-empty\r\n        chrome.runtime.sendMessage({ type: type, message: message }, (response) => { });\r\n    }\r\n}\r\n\r\ninterface Subscription {\r\n    type: string;\r\n    callback: callbackType;\r\n}\r\n\r\ntype callbackType = (message?: any) => void;\r\n","type KeyLiteral = \"lyric\" | \"track\" | \"rated\" | \"donated\" | \"notifications-disabled\"| \"notifications-duration\" | \"notifications-play-disabled\";\r\n\r\nexport class Storage {\r\n    public static async Get<T>(key: KeyLiteral): Promise<T> {\r\n        return new Promise<T>((resolve, reject) => {\r\n            chrome.storage.local.get(key, (flag) => {\r\n                resolve(flag[key] as T);\r\n            });\r\n        });\r\n    }\r\n\r\n    public static Set<T>(key: KeyLiteral, value: T) {\r\n        chrome.storage.local.set({ [key]: value });\r\n    }\r\n\r\n    public static Remove(key: KeyLiteral) {\r\n        chrome.storage.local.remove(key);\r\n    }\r\n}\r\n","import { Logger } from \"./logger\";\r\nimport { Storage } from \"./storage\";\r\nimport { delay, newGuid } from \"./utils\";\r\nimport { IConfig } from \"config\";\r\n\r\ndeclare const __CONFIG__: IConfig;\r\n\r\nexport class Tabs {\r\n  public static get(tabId: number): Promise<chrome.tabs.Tab> {\r\n    return new Promise((resolve, reject) => {\r\n      chrome.tabs.get(tabId, (tab) => {\r\n        resolve(tab);\r\n      });\r\n    });\r\n  }\r\n  public static find(): Promise<chrome.tabs.Tab[]> {\r\n    return new Promise((resolve, reject) => {\r\n      chrome.tabs.query({}, (tabs) => {\r\n        resolve(tabs.filter(t => __CONFIG__.tabUrlRegEx.test(t.url)));\r\n      });\r\n    });\r\n  }\r\n  public static query(queryInfo: chrome.tabs.QueryInfo): Promise<chrome.tabs.Tab[]> {\r\n    return new Promise((resolve, reject) => {\r\n      chrome.tabs.query(queryInfo, (tabs) => {\r\n        resolve(tabs);\r\n      });\r\n    });\r\n  }\r\n  public static executeScript<T>(tabId: number, details: chrome.tabs.InjectDetails): Promise<T[]> {\r\n    return new Promise((resolve, reject) => {\r\n      chrome.tabs.executeScript(tabId, details, (tabs) => {\r\n        resolve(tabs);\r\n      });\r\n    });\r\n  }\r\n\r\n  public static update(tabId: number, updateProperties: chrome.tabs.UpdateProperties): Promise<chrome.tabs.Tab> {\r\n    return new Promise((resolve, reject) => {\r\n      chrome.tabs.update(tabId, updateProperties, (tab) => {\r\n        resolve(tab);\r\n      });\r\n    });\r\n  }\r\n  public static getCurrent(): Promise<chrome.tabs.Tab> {\r\n    return new Promise((resolve, reject) => {\r\n      chrome.tabs.getCurrent((tab) => {\r\n        resolve(tab);\r\n      });\r\n    });\r\n  }\r\n\r\n  public static async toggleMute(tabId: number): Promise<boolean> {\r\n    let info = await Tabs.get(tabId);\r\n    let newState = !info.mutedInfo.muted;\r\n    await this.update(tabId, { muted: newState });\r\n    return newState;\r\n  }\r\n}\r\n\r\nexport class Notifications {\r\n  private static _logger = new Logger(\"Notifications Process\");\r\n\r\n  public static clear(notificationId: string): Promise<boolean> {\r\n    return new Promise((resolve, reject) => {\r\n      chrome.notifications.clear(notificationId, (isCleared) => {\r\n        resolve(isCleared);\r\n      });\r\n    });\r\n  }\r\n\r\n  public static async create(prefix: string, options: chrome.notifications.NotificationOptions) {\r\n\r\n    this._logger.info(\"Notifications enabled - displaying\", options);\r\n\r\n    let notificationId = await new Promise<string>((resolve, reject) => {\r\n      chrome.notifications.create(`${prefix}-${newGuid()}`, options, (id) => {\r\n        resolve(id);\r\n      });\r\n    });\r\n\r\n    let duration = await Storage.Get<number>(\"notifications-duration\");\r\n    await delay((duration || 3) * 1000);\r\n\r\n    await Notifications.clear(notificationId);\r\n  }\r\n}\r\n","export function newGuid(): string {\r\n  function s4() {\r\n    return Math.floor((1 + Math.random()) * 0x10000)\r\n      .toString(16)\r\n      .substring(1);\r\n  }\r\n  return s4() + s4() + \"-\" + s4() + \"-\" + s4() + \"-\" +\r\n    s4() + \"-\" + s4() + s4() + s4();\r\n}\r\n\r\nexport function delay(ms: number) {\r\n  return new Promise<void>((resolve) => {\r\n    setTimeout(resolve, ms);\r\n  });\r\n}\r\n\r\nexport function getChromeVersion() {\r\n  var raw = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\r\n  return raw ? parseInt(raw[2], 10) : false;\r\n}\r\n","import { Logger } from \"./logger\";\r\nimport { Lyric } from \"./lyric\";\r\nimport { Bus } from \"./message-bus\";\r\nimport { Resources } from \"./resources\";\r\nimport { Storage } from \"./storage\";\r\nimport { Track } from \"./track\";\r\nimport { IConfig } from \"config\";\r\nimport { Tabs } from \"asynchrome\";\r\ndeclare const __CONFIG__: IConfig;\r\n\r\nclass Main {\r\n  private _bus: Bus;\r\n  private _logger: Logger = new Logger(\"Main\");\r\n\r\n  constructor() {\r\n    this._logger.debug(\"ctor\");\r\n    this._bus = new Bus();\r\n  }\r\n\r\n  public async initialize() {\r\n    this._logger.debug(\"init\");\r\n\r\n    this._bus.on(\"idea.track.updated\", async (evt: Track) => { await this.updateTrackInfo(evt); });\r\n    this._bus.on(\"idea.track.changed\", async (evt: Track) => { await this.updateTrack(evt); });\r\n\r\n    await this.hideActions();\r\n    this.registerClicks();\r\n    this.printConsoleGreetings();\r\n  }\r\n\r\n  private async updateTrackInfo(track: Track) {\r\n    this._logger.debug(\"updating tack info\", track);\r\n\r\n    document.querySelector(\"#main\").classList.remove(\"no-player\");\r\n    (document.querySelector(\"#track-progress\") as HTMLElement).style.width =\r\n      (document.querySelector(\"#track-bar\").clientWidth * track.progress) + \"px\";\r\n    (document.querySelector(\"#volume-level\") as HTMLElement).style.width =\r\n      (document.querySelector(\"#volume-bar\").clientWidth * track.volume) + \"px\";\r\n    document.querySelector(\"#track-elapsed\").innerHTML = track.elapsed;\r\n    track.shuffle_on ? document.querySelector(\"#shuffle\").classList.add(\"active\") : document.querySelector(\"#shuffle\").classList.remove(\"active\");\r\n    track.repeat_on ? document.querySelector(\"#repeat\").classList.add(\"active\") : document.querySelector(\"#repeat\").classList.remove(\"active\");\r\n    track.is_saved ? document.querySelector(\"#save\").classList.add(\"active\") : document.querySelector(\"#save\").classList.remove(\"active\");\r\n\r\n    let isTabMuted = await this.isTabMuted();\r\n\r\n    if (track.mute_on || isTabMuted) {\r\n      document.querySelector(\"#mute\").classList.add(\"fa-volume-off\");\r\n      document.querySelector(\"#mute\").classList.remove(\"fa-volume-up\");\r\n    } else {\r\n      document.querySelector(\"#mute\").classList.add(\"fa-volume-up\");\r\n      document.querySelector(\"#mute\").classList.remove(\"fa-volume-off\");\r\n    }\r\n    if (track.is_paused) {\r\n      document.querySelector(\"#toggle\").classList.add(\"fa-pause-circle-o\");\r\n      document.querySelector(\"#toggle\").classList.remove(\"fa-play-circle-o\");\r\n    } else {\r\n      document.querySelector(\"#toggle\").classList.add(\"fa-play-circle-o\");\r\n      document.querySelector(\"#toggle\").classList.remove(\"fa-pause-circle-o\");\r\n    }\r\n\r\n    document.querySelector(\"#track-artist\").innerHTML = track.artist;\r\n    document.querySelector(\"#track-title\").innerHTML = track.title;\r\n    if (!!track.art)\r\n      document.querySelector(\"#track-art\").setAttribute(\"src\", track.art);\r\n    document.querySelector(\"#track-length\").innerHTML = track.length;\r\n\r\n    let lyric = await Storage.Get<Lyric>(\"lyric\");\r\n    if (lyric) {\r\n      document.querySelector(\"#lyrics-link\").setAttribute(\"href\", lyric.url);\r\n      document.querySelector(\"#lyrics-text\").innerHTML = lyric.lyrics.trim();\r\n      document.querySelector(\"#lyrics\").classList.remove(\"hidden\");\r\n    } else {\r\n      document.querySelector(\"#lyrics\").classList.add(\"hidden\");\r\n    }\r\n  }\r\n\r\n  private async isTabMuted(): Promise<boolean> {\r\n    let tabs = await Tabs.find();\r\n    if (tabs.length < 1) return false\r\n    var tabId = tabs[0].id;\r\n    let tab = await Tabs.get(tabId);\r\n    return tab.mutedInfo.muted;\r\n  }\r\n\r\n  private updateTrack(track: Track) {\r\n    this._logger.info(\"updating tack\", track);\r\n\r\n    document.querySelector(\"#main\").classList.remove(\"no-player\");\r\n    document.querySelector(\"#track-artist\").innerHTML = track.artist;\r\n    document.querySelector(\"#track-title\").innerHTML = track.title;\r\n    document.querySelector(\"#track-art\").setAttribute(\"src\", track.art);\r\n    document.querySelector(\"#lyrics\").classList.add(\"hidden\");\r\n  }\r\n\r\n  private async hideActions() {\r\n    if (await Storage.Get<boolean>(\"rated\")) (document.querySelector(\"#rate-outer\") as HTMLElement).style.display = \"none\";\r\n    if (await Storage.Get<boolean>(\"donated\")) (document.querySelector(\"#donation\") as HTMLElement).style.display = \"none\";\r\n    (document.querySelector(\"#settings-notification\") as HTMLInputElement).checked = !(await Storage.Get<boolean>(\"notifications-disabled\"));\r\n    (document.querySelector(\"#settings-notification-play\") as HTMLInputElement).checked = !(await Storage.Get<boolean>(\"notifications-play-disabled\"));\r\n    if (!__CONFIG__.showVolumeBar) {\r\n      (document.querySelector(\"#volume-bar\") as HTMLElement).style.display = \"none\";\r\n    }\r\n  }\r\n\r\n  private async registerClicks() {\r\n    let controls = document.getElementsByClassName(\"control\");\r\n\r\n    // tslint:disable-next-line:prefer-for-of\r\n    for (let i = 0; i < controls.length; i++) {\r\n      controls[i].addEventListener(\"click\", (evt) => {\r\n        this._logger.debug(`click: ${evt.srcElement.id}`);\r\n        this._bus.send(\"idea.cmd.player.\" + evt.srcElement.id);\r\n      });\r\n    }\r\n\r\n    document.querySelector(\"#track-bar\").addEventListener(\"click\", (evt: MouseEvent) => {\r\n      var box = document.querySelector(\"#track-bar\").getBoundingClientRect();\r\n      this._logger.debug(\"click: track bar\", { cx: evt.clientX, ox: evt.offsetX, lx: evt.layerX, x: evt.x, sx: evt.screenX, px: evt.pageX, loc: (evt.offsetX / box.width) });\r\n      this._bus.send(\"idea.cmd.player.rewind\", {\r\n        location: evt.offsetX / box.width\r\n      });\r\n    });\r\n\r\n    document.querySelector(\"#volume-bar\").addEventListener(\"click\", (evt: MouseEvent) => {\r\n      this._logger.debug(\"click: volume bar\");\r\n      var box = document.querySelector(\"#volume-bar\").getBoundingClientRect();\r\n      this._bus.send(\"idea.cmd.player.volume\", {\r\n        level: evt.offsetX / box.width\r\n      });\r\n    });\r\n\r\n    document.querySelector(\"#notification a\").addEventListener(\"click\", (evt: MouseEvent) => {\r\n      this._logger.debug(\"click: notification\");\r\n      chrome.tabs.create({ url: __CONFIG__.openPlayerUrl });\r\n      evt.preventDefault();\r\n    });\r\n\r\n    document.querySelector(\"#settings-btn\").addEventListener(\"click\", (evt: MouseEvent) => {\r\n      this._logger.debug(\"click: settings\");\r\n      document.querySelector(\"#settings\").classList.toggle(\"open\");\r\n      evt.preventDefault();\r\n    });\r\n\r\n    document.querySelector(\"#hotkeys-lnk\").addEventListener(\"click\", (evt: MouseEvent) => {\r\n      this._logger.debug(\"click: hotkeys\");\r\n      chrome.tabs.create({ url: Resources.urlChromeCommands });\r\n      evt.preventDefault();\r\n    });\r\n\r\n    document.querySelector(\"#contribute\").addEventListener(\"click\", (evt: MouseEvent) => {\r\n      this._logger.debug(\"click: contribute\");\r\n      chrome.tabs.create({ url: Resources.urlOss });\r\n      evt.preventDefault();\r\n    });\r\n\r\n    document.querySelector(\"#paypal\").addEventListener(\"click\", (evt: MouseEvent) => {\r\n      this._logger.debug(\"click: paypal\");\r\n      chrome.tabs.create({ url: Resources.urlPayPal });\r\n      Storage.Set(\"donated\", true);\r\n      evt.preventDefault();\r\n    });\r\n\r\n    document.querySelector(\"#rate\").addEventListener(\"click\", (evt: MouseEvent) => {\r\n      this._logger.debug(\"click: rate\");\r\n      chrome.tabs.create({ url: __CONFIG__.reviewsUrl });\r\n      Storage.Set(\"rated\", true);\r\n      evt.preventDefault();\r\n    });\r\n\r\n    document.querySelector(\"#settings-notification\").addEventListener(\"change\", (evt: MouseEvent) => {\r\n      let enabled = (evt.target as HTMLInputElement).checked;\r\n      this._logger.info(`change: notifications enabled: ${enabled}`);\r\n      Storage.Set(\"notifications-disabled\", !enabled);\r\n      evt.preventDefault();\r\n    });\r\n\r\n    document.querySelector(\"#settings-notification-play\").addEventListener(\"change\", (evt: MouseEvent) => {\r\n      let enabled = (evt.target as HTMLInputElement).checked;\r\n      this._logger.info(`change: notifications play enabled: ${enabled}`);\r\n      Storage.Set(\"notifications-play-disabled\", !enabled);\r\n      evt.preventDefault();\r\n    });\r\n\r\n    var duration = await Storage.Get<number>(\"notifications-duration\");\r\n    (document.querySelector(\"#settings-notification-duration\") as HTMLInputElement).value = (duration || 3).toString();\r\n    document.querySelector(\"#settings-notification-duration\").addEventListener(\"change\", (evt: MouseEvent) => {\r\n      let duration = ~~(evt.target as HTMLInputElement).value;\r\n      this._logger.info(`change: notification duration: ${duration}`);\r\n      Storage.Set(\"notifications-duration\", duration);\r\n      evt.preventDefault();\r\n    });\r\n  }\r\n\r\n  private printConsoleGreetings() {\r\n    this._logger.info(Resources.msgDontHack);\r\n    this._logger.info(Resources.msgBuyBeer);\r\n    this._logger.info(Resources.msgRate);\r\n  }\r\n}\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\r\n  let main = new Main();\r\n  await main.initialize();\r\n});\r\n","import { IConfig } from \"config\";\r\n\r\ndeclare const __CONFIG__: IConfig;\r\n\r\nexport class Resources {\r\n  public static urlOss = \"https://github.com/Sergej-Popov/SpotifyControls\";\r\n  public static urlPayPal = \"https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=TRUHY87YGGRLY\";\r\n  public static urlChromeCommands = \"chrome://extensions/configureCommands\";\r\n\r\n  public static msgDontHack = `No need to hack around.. This app is open source: ${Resources.urlOss}`;\r\n  public static msgBuyBeer = `\"Learned a thing or two? Buy me a beer: ${Resources.urlPayPal} (PayPal donation)\"`;\r\n  public static msgRate = `And don't forget to rate! ${__CONFIG__.reviewsUrl}`;\r\n}\r\n"],"sourceRoot":""}